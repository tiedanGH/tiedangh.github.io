<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="基于 glot.io 的在线代码执行器，支持从 URL 获取代码"/>
    <meta property="og:image" content="https://tdgame.tiedan.site/assets/icons/tiedan.png">

    <title>Glot 代码执行器</title>
    <link rel="icon" href="favicon.ico">

    <!-- WebApp -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="代码执行器">
    <link rel="apple-touch-icon" href="../assets/icons/games/code_runner.png"/>

    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script src="https://cdn.jsdelivr.net/npm/crypto-js@4.2.0/crypto-js.min.js"></script>
    <script src="js/main.js"></script>
</head>
<body>
<div class="container">
    <header>
        <a href="../" class="back-home">返回主页</a>
        <h1>Glot 代码执行器</h1>
        <p>基于 <a href="https://glot.io" target="_blank">glot.io</a> API 的在线代码执行工具</p>
    </header>

    <!-- HTTPS警告 -->
    <div id="httpsWarning" class="warning-banner" style="display: none;">
        <div class="warning-content">
            <i class="fas fa-exclamation-triangle"></i>
            <div class="warning-text">
                <strong>安全警告：</strong>当前页面未使用HTTPS协议，您的API Key存在泄露风险！
                <br>建议使用安全链接：<a href="https://page.tiedan.site/code_runner" target="_blank">https://page.tiedan.site/code_runner</a>
                ，或访问官方网站：<a href="https://glot.io" target="_blank">https://glot.io</a>
            </div>
        </div>
    </div>

    <main>
        <div class="content-wrapper">
            <div class="form-container">
                <form id="codeForm">
                    <div class="form-group">
                        <label for="apiKey">
                            Glot API Key
                            <span class="tooltip">
                                <i class="fas fa-info-circle"></i>
                                <div class="tooltip-content">
                                    <strong>安全提示：</strong><br>
                                    • 请求默认通过第三方代理服务器(cors-anywhere)发送<br>
                                    • 建议安装用户脚本替代中间服务器，以建立安全连接<br>
                                    • 在HTTPS环境下使用更安全<br>
                                    • 定期轮换您的API Key
                                </div>
                            </span>
                        </label>
                        <div id="apiKeyHint" class="api-key-hint" style="display: none;">
                            <i class="fas fa-info-circle"></i>
                            <span>没有API Key？<a href="https://glot.io/account/token" target="_blank">前往官网3分钟注册一个</a></span>
                        </div>
                        <div class="password-container">
                            <input type="password" id="apiKey" placeholder="请输入您的 Glot API Key" required>
                            <button type="button" id="togglePassword" class="password-toggle">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <div id="security-notice" class="security-notice">
                            <i id="security-notice-icon" class="fas fa-shield-alt"></i>
                            <span id="security-notice-text">API Key将通过第三方代理服务器发送，建议使用专用Key，或者<a href="userscript/cors/dist/main.user.js">安装用户脚本</a></span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="language">编程语言</label>
                        <select id="language" required>
                            <option value="">请选择语言</option>
                            <option value="python">Python</option>
                            <option value="javascript">JavaScript</option>
                            <option value="java">Java</option>
                            <option value="c">C</option>
                            <option value="cpp">C++</option>
                            <option value="go">Go</option>
                            <option value="rust">Rust</option>
                            <option value="ruby">Ruby</option>
                            <option value="php">PHP</option>
                            <option value="swift">Swift</option>
                            <option value="typescript">TypeScript</option>
                            <option value="bash">Bash</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="codeSource">代码来源</label>
                        <select id="codeSource">
                            <option value="textarea">在文本框内输入代码</option>
                            <option value="url">从 URL 获取代码</option>
                        </select>
                    </div>

                    <div class="form-group" id="urlGroup" style="display: none;">
                        <label for="codeUrl">
                            代码 URL
                            <span class="tooltip">
                                <i class="fas fa-info-circle"></i>
                                <div class="tooltip-content">
                                    支持的网站:<br>
                                    • https://pastebin.ubuntu.com/p/<br>
                                    • https://glot.io/snippets/<br>
                                    • https://pastebin.com/raw/<br>
                                    • https://gist.githubusercontent.com/<br>
                                    • https://bytebin.lucko.me/<br>
                                    • https://pastes.dev/<br>
                                    • https://p.ip.fi/
                                </div>
                            </span>
                        </label>
                        <input type="url" id="codeUrl" placeholder="请输入代码 URL">
                    </div>

                    <div class="form-group" id="codeGroup">
                        <label for="code">代码</label>
                        <textarea id="code" placeholder="请输入您的代码" rows="15"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="stdin">程序输入 (stdin)</label>
                        <textarea id="stdin" placeholder="请输入程序的标准输入（可选）" rows="3"></textarea>
                    </div>

                    <!-- 调试模式开关 - 在HTTPS环境下隐藏 -->
                    <div class="form-group debug-section" id="debugSection">
                        <label class="checkbox-label">
                            <input type="checkbox" id="debugMode">
                            <span class="checkmark"></span>
                            调试模式（允许在非HTTPS环境下执行）
                        </label>
                        <div class="debug-notice">
                            <i class="fas fa-bug"></i>
                            启用后可在HTTP环境下执行代码，但API Key安全性无法保证
                        </div>
                    </div>

                    <button type="submit" id="runButton">
                        <i class="fas fa-play"></i> 执行代码
                    </button>
                </form>
            </div>

            <div class="result-container" id="result" style="display: none;">
                <h2>执行结果</h2>
                <div id="output"></div>
            </div>
        </div>
    </main>
</div>
</body>
</html>
